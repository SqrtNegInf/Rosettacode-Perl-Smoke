#!/usr/local/bin/perl
#u# https://rosettacode.org/wiki/Inventory_sequence
#c# 2023-0x-xx >RC
#p# OK

my @res;

use v5.36;

use List::AllUtils <max firstidx>;

sub table { my $t = 20 * (my $c = 1 + length max @_); ( sprintf( ('%'.$c.'d')x@_, @_) ) =~ s/.{1,$t}\K/\n/gr }

my($i, @inventory, %i) = 0;

do {
    my $count = $i{$i} // 0;
    $i = $count ? $i+1 : 0;
    ++$i{$count};
    push @inventory, $count
} until 100 == @inventory;

push @res, "Inventory sequence, first 100 elements:\n" .  table @inventory;
say my $result = join "\n", @res;

my $ref = <<'END';
Inventory sequence, first 100 elements:
  0  1  1  0  2  2  2  0  3  2  4  1  1  0  4  4  4  1  4  0
  5  5  4  1  6  2  1  0  6  7  5  1  6  3  3  1  0  7  9  5
  3  6  4  4  2  0  8  9  6  4  9  4  5  2  1  3  0  9 10  7
  5 10  6  6  3  1  4  2  0 10 11  8  6 11  6  9  3  2  5  3
  2  0 11 11 10  8 11  7  9  4  3  6  4  5  0 12 11 10  9 13
END

use Test::More;
is($result, $ref);
done_testing;
