#!/usr/local/bin/perl
#u# http://rosettacode.org/wiki/Jacobsthal_numbers
#c# 2022-02-xx >RC
#p# OK

my @res;

use strict;
use warnings;
use feature <say state>;

use bigint;  
use List::Util 'max';
use ntheory 'is_prime';

sub pp { my $t = 5 * (my $c = 1 + length max @_); ( sprintf( ('%'.$c.'d')x@_, @_) ) =~ s/.{1,$t}\K/\n/gr }

sub jacobsthal {
    my($n) = @_;
    state @J = (0, 1);
    do { push @J, $J[-1] + 2 * $J[-2]} until @J > $n;
    $J[$n];
}

sub jacobsthal_lucas {
    my($n) = @_;
    state @JL = (2, 1);
    do { push @JL, $JL[-1] + 2 * $JL[-2]} until @JL > $n;
    $JL[$n];
}

my(@j,@jl,@jo,@jp,$c,$n);

push @res, "First 30 Jacobsthal numbers:";
push @j, jacobsthal($_) for 0..29;
push @res, pp @j;

push @res, "First 30 Jacobsthal-Lucas numbers:";
push @jl, jacobsthal_lucas($_) for 0..29;
push @res, pp @jl;

push @res, "First 20 Jacobsthal oblong numbers:";
push @jo, $j[$_] * $j[$_+1] for 0..19;
push @res, pp @jo;

push @res, "First 20 Jacobsthal primes:";
do { is_prime($n = jacobsthal(++$c)) and push @jp, $n } until @jp == 20;
push @res, $_ for @jp;

say my $result = join "\n", @res;

my $ref = <<'END';
First 30 Jacobsthal numbers:
         0         1         1         3         5
        11        21        43        85       171
       341       683      1365      2731      5461
     10923     21845     43691     87381    174763
    349525    699051   1398101   2796203   5592405
  11184811  22369621  44739243  89478485 178956971

First 30 Jacobsthal-Lucas numbers:
         2         1         5         7        17
        31        65       127       257       511
      1025      2047      4097      8191     16385
     32767     65537    131071    262145    524287
   1048577   2097151   4194305   8388607  16777217
  33554431  67108865 134217727 268435457 536870911

First 20 Jacobsthal oblong numbers:
           0           1           3          15          55
         231         903        3655       14535       58311
      232903      932295     3727815    14913991    59650503
   238612935   954429895  3817763271 15270965703 61084037575

First 20 Jacobsthal primes:
3
5
11
43
683
2731
43691
174763
2796203
715827883
2932031007403
768614336404564651
201487636602438195784363
845100400152152934331135470251
56713727820156410577229101238628035243
62357403192785191176690552862561408838653121833643
1046183622564446793972631570534611069350392574077339085483
267823007376498379256993682056860433753700498963798805883563
5562466239377370006237035693149875298444543026970449921737087520370363869220418099018130434731
95562442332919646317117537304253622533190207882011713489066201641121786503686867002917439712921903606443
END

use Test::More;
chomp $ref;
is($result, $ref);
done_testing();

__END__

=={{header|Perl}}==
{{libheader|ntheory}}
<lang perl>
</lang>
{{out}}
<pre>
</pre>
